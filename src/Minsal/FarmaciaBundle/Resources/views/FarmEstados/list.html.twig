{# src/Minsal/FarmaciaBundle/Resources/views/FarmMedicinarecetada/list.html.twig #}
{% extends 'SonataAdminBundle::layout.html.twig' %}
{% block stylesheets %}
    {{parent()}}
    <link rel="stylesheet" href="{{ asset('bundles/minsalsiaps/css/MntExpediente/list.css') }}" type="text/css" media="all" />
{% endblock %}

{% block javascripts %}
    {{parent()}}
    <script src="{{ asset('bundles/minsalsiaps/js/maskedinput/jquery.maskedinput.js') }}" type="text/javascript"></script>

    <script type="text/javascript">
        $(document).ready(function () {
          $("#fecha_inicio").mask("99/99/9999");
          $("#fecha_fin").mask("99/99/9999");
          $("#fecha_consulta").mask("99/99/9999");

          $("#emitir_informe").click(function (event) {
            if (($("#fecha_inicio").val() == '' && $("#fecha_fin").val() == '') && $('#fecha_consulta').val()=='') {
              var title='Error de Llenado';
              var body="Debe de seleccionar la fecha de consulta o el rango de derivación";
              var clase='dialog-error';
              var arrayBtns = [{text: 'Cerrar',
              click: function( event, ui) {
                jQuery( this ).dialog( "close" );
                $("#fecha_inicio").focus();
              }
            }];
            showDialogMsg(title, body, clase, '', arrayBtns, false, null, true);
            event.preventDefault();
          }else if ($('#fecha_consulta').val()=='') {
            if(($("#fecha_inicio").val() == '' && $("#fecha_fin").val() == '') ){
              var title='Error de Llenado';
              var body="Debe de seleccionar ambas fechas";
              var clase='dialog-error';
              var arrayBtns = [{text: 'Cerrar',
              click: function( event, ui) {
                jQuery( this ).dialog( "close" );
                if ($("#fecha_inicio").val() == '')
                $("#fecha_inicio").focus();
                else
                $("#fecha_fin").focus();
              }}
            ];
            showDialogMsg(title, body, clase, '', arrayBtns, false, null, true);
            event.preventDefault();
          } else if ($("#fecha_inicio").datepicker("getDate") > $("#fecha_fin").datepicker("getDate") && $('#fecha_consulta').val()!='') {
            var title='Error de Llenado';
            var body="La fecha de inicio debe de ser menor que la fecha fin.";
            var clase='dialog-error';
            var arrayBtns = [{text: 'Cerrar',
            click: function( event, ui) {
              jQuery( this ).dialog( "close" );
              $("#fecha_inicio").val('');
              $("#fecha_fin").val('');
              $("#fecha_inicio").focus();
            }}
          ];
          showDialogMsg(title, body, clase, '', arrayBtns, false, null, true);
          event.preventDefault();
        }else {
          $('#resultado').load(Routing.generate("cargar_pacientes_derivados"), {'datos': $('#cargar_pacientes_derivados').serialize()});
        }
      } else {
        $('#resultado').load(Routing.generate("cargar_pacientes_derivados"), {'datos': $('#cargar_pacientes_derivados').serialize()});
      }
      event.preventDefault();
    });

    $("#btn_cancel").click(function () {
      $('#resultado').empty();
    });
  });
</script>
{% endblock %}

{% block content -%}
<center>
    <div style="text-align: center;width:60%;">

        <form  id="cargar_pacientes_derivados" method="post" >
            <table class="table table-bordered ">
                <tbody>

                    <tr>
                        <td colspan="4" id="titulo_parametro" class="sonata-ba-list-field-header"><strong>Opciones de Contenido</strong></td>
                    </tr>
                    <tr>
                        <td class=""><strong>Fecha Inicial de Derivación:</strong></td>
                        <td><input id="fecha_inicio" name="fecha_inicio" type="text" class="fecha form-control bootstrap-datepicker form-control" /></td>
                        <td class=" "><strong>Fecha Final de Derivación:</strong></td>
                        <td><input id="fecha_fin" name="fecha_fin" type="text" class="fecha form-control bootstrap-datepicker form-control" /></td>
                    </tr>
                    <tr>
                        <td class=""><strong>Fecha de consulta:</strong></td>
                        <td><input id="fecha_consulta" name="fecha_consulta" type="text" class="fecha form-control bootstrap-datepicker now form-control" /></td>
                        <td colspan="2"></td>
                    </tr>
                </tbody>
            </table>
            <div class="well form-actions">
                <input type="submit" class="btn btn-primary" id="emitir_informe" name="emitir_informe" value="Emitir Informe"/>
                <input type="reset" class="btn btn-info" id="btn_cancel" name="btn_cancel" value="Limpiar"/>
            </div>
        </form>
      </div>
  </center>
        <div id="resultado" ></div>

{% endblock -%}
