{# src/Minsal/SeguimientoBundle/Resources/views/SecIngreso/reporte_list.html.twig #}
{% extends 'SonataAdminBundle::layout.html.twig' %}
{% block stylesheets %}
    {{parent()}}
    <link rel="stylesheet" href="{{ asset('bundles/minsalseguimiento/css/SecIngreso/reporte_list.css') }}" type="text/css" media="all" />
{% endblock %}


{% block javascripts %}
    {{parent()}}
<script src="{{ asset('bundles/minsalsiaps/js/maskedinput/jquery.maskedinput.js') }}" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#servicio_ingreso').select2({
        width: '60%',
        placeholder:'Seleccione...',
        allowClear:true
    });

    $("#fecha_inicio").mask("99/99/9999");
    $("#fecha_fin").mask("99/99/9999");

    $("#emitir_informe").click(function(event) {
        if ($("#fecha_inicio").val() == '' || $("#fecha_fin").val() == '') {
            var title='Error de Llenado';
            var body="Debe de seleccionar ambas fechas para generar el reporte.";
            var clase='dialog-error';
            var arrayBtns = [{text: 'Cerrar',
                                    click: function( event, ui) {
                                        jQuery( this ).dialog( "close" );
                                        if ($("#fecha_inicio").val() == '')
                                            $("#fecha_inicio").focus();
                                        else
                                            $("#fecha_fin").focus();
                                    }}
                            ];
            showDialogMsg(title, body, clase, '', arrayBtns, false, null, true);
            event.preventDefault();
        } else if( $("#fecha_inicio").datepicker("getDate") > $("#fecha_fin").datepicker("getDate")){
            var title='Error de Llenado';
            var body="La fecha de inicio debe de ser menor que la fecha fin.";
            var clase='dialog-error';
            var arrayBtns = [{text: 'Cerrar',
                                    click: function( event, ui) {
                                        jQuery( this ).dialog( "close" );
                                        $("#fecha_inicio").val('');
                                        $("#fecha_fin").val('');
                                        $("#fecha_inicio").focus();
                                    }}
                            ];
            showDialogMsg(title, body, clase, '', arrayBtns, false, null, true);
            event.preventDefault();
        } else {
            $('#resultado').empty();
            $('#resultado').append('<center><img id="wait" src="{{ asset("bundles/minsalsiaps/imagenes/wait_icon1.gif") }}" alt="wait" width="24" height="24"><div id="search-message">Por Favor Espere...</div></center>');
            $('#resultado').load(Routing.generate('buscar_ingresos_pacientes',{'datos':$('#pacientesIngresados').serialize()}));
        }
        return false;
    });

    $.getJSON(Routing.generate('get_servicios_hospitalarios_todos'),
    function(data) {
        $.each(data.especialidades, function(indice, aux) {
            $('#servicio_ingreso').append('<option value="' + aux.id + '">' + aux.nombre + '</option>');
        });
    });
});

</script>
{% endblock %}
{% block sonata_admin_content -%}
<h4><img class="icono" src={{ asset('bundles/minsalsiaps/imagenes/listar.png') }} />Listado de Ingresos</h4>
<center>
    <form  id="pacientesIngresados" method="post" >
        <table class="table table-bordered ">
            <tbody>
                <tr>
                    <td colspan="4" id="titulo_parametro" class="sonata-ba-list-field-header"><strong>Opciones de Contenido</strong></td>
                </tr>
                <tr>
                    <td class=""><strong>Fecha Inicial</strong></td>
                    <td><input id="fecha_inicio" name="fecha_inicio" type="text" class="fecha bootstrap-datepicker now form-control" style="width:100px;" /></td>
                    <td class=" "><strong>Fecha Final</strong></td>
                    <td><input id="fecha_fin" name="fecha_fin" type="text" class="fecha bootstrap-datepicker now form-control" style="width:100px;" /></td>
                </tr>
                <tr>
                    <td class="" ><strong>Servicio</strong></td>
                    <td colspan="3" ><select id="servicio_ingreso" name="servicio_ingreso">
                        <option></option>
                    </select></td>
                </tr>
            </tbody>
        </table>
        <div class="well form-actions">
            <input type="submit" class="btn btn-primary" id="emitir_informe" name="btn_generate" value="Emitir Informe"/>
        </div>
    </form>
    <div id="resultado" ></div>
</center>
{% endblock -%}

{# empty Twig template #}
